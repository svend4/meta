# Roadmap: проект `hexboya` на основе «Тотальной системы боя» Крюкова В.В.

**Дата:** 21 февраля 2026 г.
**Источник:** `totalnaya_sistema_boya.pdf` — книга В.В. Крюкова, ООО «ТОТАЛ»
**Анализ:** `analysis_totalnaya.md`

---

## Ключевое открытие

```
Система окон (6 зон тела):
  Верхнее левое/правое  → биты 0, 1
  Среднее левое/правое  → биты 2, 3
  Нижнее левое/правое   → биты 4, 5

  h ∈ {0..63}  =  Q6  =  64 состояния тела бойца

Каждый глиф Q6 = боевое состояние бойца по Крюкову.
```

---

## Проект: `hexboya` — Тотальная система боя: Q6-модель

**Область:** Боевые искусства, комбинаторика, теория графов
**Приоритет:** Tier 1 — прямое и полное Q6-отображение
**Размер:** ~400 строк

---

## Математика

### Система окон → Q6

```python
ZONES = [
    "upper_left",   # бит 0: верхнее левое окно
    "upper_right",  # бит 1: верхнее правое окно
    "mid_left",     # бит 2: среднее левое окно
    "mid_right",    # бит 3: среднее правое окно
    "low_left",     # бит 4: нижнее левое окно
    "low_right",    # бит 5: нижнее правое окно
]

# Состояние тела: h = bitmask открытых окон
# h=0 (000000): все закрыто — полная защита
# h=63 (111111): всё открыто — полная атака
# yang(h): число открытых окон (0..6)
```

### Законы чёрного ящика → метрика Q6

```
Закон 1: ≤2 движений для поражения цели
  ↔ Гамминг-расстояние hamming(h1, h2) ≤ 2

Закон 2: ≤3 движений в одной атаке
  ↔ Путь в Q6 длиной ≤ 3 (шар радиуса 3)

Закон памяти: суммарный путь ≤ 9
  ↔ Длина маршрута в Q6 ≤ 9

Оптимум арсенала: 7-9 техник
  ↔ 7-9 орбит под группой симметрий Q6
```

### Восьмёрка (лемниската) → маршрут в Q6

```
Лемниската как граф: два цикла с общей вершиной (θ-граф)

В Q6: восьмёрка = маршрут через два 4-цикла:
  Петля 1: h → flip(h,0) → flip(h,0,1) → flip(h,1) → h
  Петля 2: h → flip(h,2) → flip(h,2,3) → flip(h,3) → h

Пересечение в h = «перекрест восьмёрки»

Реализация через Q6 4-циклы (квадраты гиперкуба):
  subcube_2d = [(i,j) for пары бит i,j]
  Таких квадратов в Q6: C(6,2) = 15
```

### МВС/СВС/БВС → концентрические граф-структуры

```
МВС (малая сфера, r₁): шар радиуса 1 в Q6
  ball(h, 1) = {h} ∪ neighbors(h)  — 7 вершин

СВС (средняя сфера, r₂): шар радиуса 2 в Q6
  ball(h, 2) = 22 вершины

БВС (большая сфера, r₃): шар радиуса 3 в Q6
  ball(h, 3) = 42 вершины

Полный Q6: ball(h, 6) = все 64 вершины
```

### Закон сильного справа → ориентированный граф

```
Круговая доминанта стилей (8 животных):
  Tiger → Crane → Snake → Mantis
    ↑                        ↓
  Bear ← Monkey ← Leopard ← Duck

Нетранзитивное превосходство:
  dom[i] = (i + 1) % N   (N = число стилей)

В Q6: доминанта = путь по Грею (Gray code)
  Каждый следующий глиф отличается ровно на 1 бит
```

### Законы нечётных действий → паритет Q6

```
Чётный путь в Q6: возвращает к той же чётности yang
  path_length % 2 == 0  →  yang(start) % 2 == yang(end) % 2

Нечётный путь: меняет паритет
  path_length % 2 == 1  →  yang(start) % 2 ≠ yang(end) % 2

"Зеркальное повторение без прерывания":
  Нечётный маршрут → антипод на следующем шаге
  Это возможно только при нечётном числе флипов
```

---

## Python API

```python
from hexboya import BodyState, FigureEight, SphereSystem, CombatLaws

# === Состояние тела (система окон) ===
state = BodyState(h=21)  # h=010101: правые окна открыты

state.zones()            # → {'upper_left': False, 'upper_right': True, ...}
state.open_zones()       # → ['upper_right', 'mid_right', 'low_right']
state.yang_level()       # → 3 (три открытых окна)
state.is_symmetric()     # → True (только правые)
state.antipode()         # → BodyState(42) — полная инверсия

# Переходы
state.open_zone('upper_left')    # → BodyState(21 | 1) = 23
state.close_zone('upper_right')  # → BodyState(21 & ~2) = 19
state.flip_zone('mid_left')      # → toggle бит 2

# Атака: цель в зоне, есть ли открытое окно?
state.can_attack('mid_right')    # → True
state.attack_path(target_state)  # → кратчайший путь в Q6

# === Восьмёрка ===
fig8 = FigureEight(h=0, axis_pair=(0,1))  # восьмёрка по битам 0 и 1

fig8.cycle()       # → [0, 1, 3, 2, 0]  (4-цикл)
fig8.trajectory()  # → [(x,y) точки лемнискаты]
fig8.q6_path()     # → маршрут по Q6
fig8.all_figure8s() # → все 15 возможных восьмёрок в Q6 (C(6,2))

# === Система сфер ===
spheres = SphereSystem(center=0)

spheres.mvs()      # → ball(0, 1)  — 7 вершин МВС
spheres.svs()      # → ball(0, 2)  — 22 вершины СВС
spheres.bvs()      # → ball(0, 3)  — 42 вершины БВС
spheres.zone(h)    # → 'МВС'/'СВС'/'БВС'/None (какая сфера)
spheres.ascii()    # → ASCII-схема трёх сфер

# === Законы боя ===
laws = CombatLaws()

laws.is_valid_attack(path)          # → path длины ≤ 3?
laws.hamming_ok(h1, h2)             # → hamming ≤ 2?
laws.is_odd_path(path)              # → нечётная длина?
laws.can_mirror(path)               # → нечётный? → можно зеркалить
laws.arsenal_optimal(techniques)    # → 7 ≤ len ≤ 9?
laws.memory_ok(technique)           # → sum(path_lengths) ≤ 9?

# === Круговая доминанта ===
dom = AnimalCycle()

dom.animals     # → ['тигр', 'журавль', 'змея', 'богомол', 'обезьяна', 'леопард', 'медведь', 'утка']
dom.beats(a, b) # → True/False: a побеждает b?
dom.style_q6(a) # → h: Q6-глиф для стиля a
dom.cycle_path  # → Грей-код Q6, порождающий цикл

# === Режимы действий ===
mode = CombatMode('фехтование')

mode.sphere()      # → 'БВС'
mode.preferred_zones()  # → зоны атаки
mode.typical_yang()     # → 2 (мало открытых окон)
```

---

## CLI

```
python hexboya.py --state 21         → состояние h=21, открытые зоны
python hexboya.py --state 21 --ascii → ASCII тело с отмеченными зонами
python hexboya.py --attack 21 42     → путь атаки от h=21 к h=42
python hexboya.py --figure8 0 01     → восьмёрка от h=0 по осям 0,1
python hexboya.py --spheres 0        → МВС/СВС/БВС вокруг h=0
python hexboya.py --animals          → круговая доминанта
python hexboya.py --laws 0 21 42     → проверка законов для маршрута
python hexboya.py --yin-yang         → инь-ян разбиение Q6
python hexboya.py --arsenal          → примеры арсенала 7-9 техник
python hexboya.py --gray             → Грей-код Q6 = закон сильного справа
```

---

## ASCII-схема состояния тела

```
       ╔═══════╦═══════╗
       ║  ВЛ   ║  ВП   ║   (биты 0, 1)
       ║ [■]   ║ [ ]   ║   ■=открыто □=закрыто
       ╠═══════╬═══════╣
       ║  СЛ   ║  СП   ║   (биты 2, 3)
       ║ [■]   ║ [ ]   ║
       ╠═══════╬═══════╣
       ║  НЛ   ║  НП   ║   (биты 4, 5)
       ║ [■]   ║ [ ]   ║
       ╚═══════╩═══════╝
       h=010101=21  yang=3
```

---

## Связи с другими проектами

| Проект | Связь |
|--------|-------|
| `hexkub` | Куб = пространство трёх сфер МВС/СВС/БВС |
| `hexglyph` | 64 глифа = 64 состояния окон тела |
| `hexdim` | Q6-структура окон |
| `hexphi` | Золотое сечение = пропорции тела бойца |
| `hexgeom` | Сферы МВС/СВС/БВС = геометрические шары в Q6 |
| `hexphys` | Биомеханика восьмёрки |
| `hexnumderiv` | Законы нечётных чисел |
| `hexcubenets` | Развёртки куба = развёртки системы сфер |

---

## Приоритет реализации

**Tier 1** (ядро):
- `body_state` — BodyState: 6-битовое Q6-состояние тела
- `figure8` — FigureEight: восьмёрка как маршрут в Q6
- `spheres` — SphereSystem: МВС/СВС/БВС как шары в Q6
- `laws` — CombatLaws: проверка законов чёрного ящика

**Tier 2**:
- `animals` — AnimalCycle: круговая доминанта стилей
- `modes` — CombatMode: 5 режимов действий

**Tier 3**:
- `arsenal` — генерация оптимального арсенала 7-9 техник
- `language` — язык боя, уровни стратегического мышления

---

*Roadmap составлен: 21 февраля 2026 г.*
*Источник: «Тотальная система боя», В.В. Крюков, ООО «ТОТАЛ»*
